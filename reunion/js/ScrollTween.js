var ScrollTween=this["ScrollTween"]||{};(function(e){function o(r,i){var s=this;this.settings={touchSpeed:5,wheelSpeed:45,tweenSpeed:.3};e.extend(this.settings,i);this._elems=[];this._tweens=[];this.tweenTop=0;this.scrollTop=0;this.scrollEnd=0;var o=this.target=e(r);o.css("overflow","hidden");var u=o.css("position");if(u!=="position"||u==="static"){o.css("position","relative")}(function(){var t={},n;if("ontouchstart"in window){o[0].addEventListener("touchstart",function(e){var r=e.touches;t.x=r[0].pageX;t.y=r[0].pageY;n=s.scrollTop},true);o[0].addEventListener("touchmove",function(e){e.preventDefault();var r=e.touches;var i=t.y-r[0].pageY;s.scrollTop=Math.max(0,n+i*(1+s.settings.touchSpeed));if(s.scrollTop<0)s.scrollTop=0;if(s.scrollEnd<s.scrollTop)s.scrollTop=s.scrollEnd},true);o[0].addEventListener("touchend",function(e){},true)}})();n.on("mousewheel",function(e,t,n,r){e.preventDefault();s.scrollTop-=t*s.settings.wheelSpeed;if(s.scrollTop<0)s.scrollTop=0;if(s.scrollEnd<s.scrollTop)s.scrollTop=s.scrollEnd});t.on("resize",function(){s.stop();if(typeof s.onresize==="function"){s.onresize.call(this)}s.play()})}function u(){return window.performance&&window.performance.webkitNow?performance.webkitNow():(new Date).getTime()}function a(e){this.tween=e;var t=this.$tweenTarget=e.target;this._widthOfTweenTarget=t.width();this._heightOfTweenTarget=t.height();this._hWidthOfTweenTarget=this._widthOfTweenTarget/2;this._hHeightOfTweenTarget=this._heightOfTweenTarget/2;var n=this.container=e.container;this._widthOfContainer=n.width();this._heightOfContainer=n.height();this._hWidthOfContainer=this._widthOfContainer/2;this._hHeightOfContainer=this._heightOfContainer/2;this._styles={}}function l(e,t){this.target=e;this.container=t;this.keyframes=[];this.initialized=false;this.rendering=false;this._framePositions=[];this._debug=false;this.startPos=0;this.endPos=0;this._onenter=null;this._onprogress=null}function h(e){if(e===undefined){return undefined}if(typeof e==="number"){return{value:e}}if(!c.test(e)){throw new Error("Bad value:"+e)}return{value:parseInt(RegExp.$1,10),unit:RegExp.$2,toString:function(){return e}}}var t=e(window),n=e(document),r=window.console||{log:function(){},debug:function(){},error:function(){}},i={tick:50};e.extend(i,ScrollTween.settings);var s=function(){var e=[],t=i.tick,n=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,t)};var r=function(t){for(var i=0,s=e.length;i<s;i++){e[i].render(t)}if(e.length!==0){n(r)}};return{join:function(t){var n=false;for(var i=0,s=e.length;i<s;i++){if(e[i]===t){n=true;break}}if(!n){e.push(t);if(e.length===1){r()}}},leave:function(t){var n=[];for(var r=0,i=e.length;r<i;r++){if(e[r]!==t){n.push(e[r])}}e=n}}}();o.prototype={add:function(t,n){this._elems.push({elem:e(t).css({position:"absolute",display:"none"}),configurator:n})},resize:function(e){this.onresize=e},progress:function(e){this.onprogress=e},play:function(){var e=this,t=this._elems,n=this._tweens=[],r=0;for(var i=0,o=t.length;i<o;i++){var u=t[i];var a=new l(u.elem,this);u.configurator.call(u.elem,a);a.init();n.push(a);if(a.endPos>r){r=a.endPos}}e.scrollEnd=r;s.join(this);e.scrollTop++},stop:function(){var e=this._tweens;if(e){for(var t=0,n=e.length;t<n;t++){e[t].end()}delete this._tweens}},width:function(){return this.target.width()},height:function(){return this.target.height()},getScrollTop:function(){return this.scrollTop},getScrollEnd:function(){return this.scrollEnd},isScrollEnd:function(){return this.scrollTop>=this.scrollEnd},scroll:function(e){this.scrollTo(this.scrollTop+e)},scrollTo:function(e){if(e<0){e=0}else if(e>this.scrollEnd){e=this.scrollEnd}this.scrollTop=e},render:function(){var e=this,t=e._tweens,n=e.scrollTop,r=e.tweenTop;if(Math.abs(n-r)<1){return}var i=u();r+=e.settings.tweenSpeed*(n-r);e.tweenTop=r;for(var s=0,o=t.length;s<o;s++){var a=t[s];if(r>=a.startPos&&r<=a.endPos){a.render()}else{a.end()}}if(typeof this.onprogress==="function"){this.onprogress.call(this)}var f=u()}};a.prototype={center:function(e){var t=this._hWidthOfContainer-this._hWidthOfTweenTarget;if(e){if(-1<e&&e<1){e=this._widthOfContainer*e}t+=e}this._styles.left=t;return this},middle:function(e){var t=this._hHeightOfContainer-this._hHeightOfTweenTarget;if(e){if(-1<e&&e<1){e=this._heightOfContainer*e}t+=e}this._styles.top=t;return this},bottom:function(e){var t=this._heightOfContainer-this._heightOfTweenTarget;if(e){if(-1<e&&e<1){e=this._heightOfContainer*-e}t+=e}this._styles.top=t;return this},bottomOut:function(){this._styles.top=this._heightOfContainer;return this},top:function(e){var t=0;if(e){if(-1<e&&e<1){e=this._heightOfContainer*e}t+=e}this._styles.top=t;return this},topOut:function(){this._styles.top=-this._heightOfTweenTarget;return this},left:function(e){var t=0;if(e){if(-1<e&&e<1){e=this._widthOfContainer*e}t+=e}this._styles.left=t;return this},leftOut:function(){this._styles.left=-this._widthOfTweenTarget;return this},right:function(e){var t=this._widthOfContainer-this._widthOfTweenTarget;if(e){if(-1<e&&e<1){e=this._widthOfContainer*-e}t+=e}this._styles.left=t;return this},rightOut:function(){this._styles.left=this._widthOfContainer;return this},extend:function(t){e.extend(this._styles,t);return this},clone:function(){var e=this.tween.styles();e.extend(this._styles);return e},get:function(){return this._styles},apply:function(){this.$tweenTarget.css(this.get())}};var f={linear:function(e){return e},"ease-in":function(e){return e*e*e*e},"ease-out":function(e){return-e*(e-2)},"ease-in-out":function(e){if((e*=2)<1)return.5*e*e;return-.5*(--e*(e-2)-1)}};l.prototype={width:function(){return this.target.width()},height:function(){return this.target.height()},to:function(e,t,n){if(typeof t==="function"){t=t.call(this)}if(!t){t={}}if(t instanceof a){t=t.get()}this.keyframes.push({scrollTop:e,styles:t,options:n});this._framePositions.push(e);return this},range:function(e,t,n,r,i){this.to(e,n,r);this.to(t,n,i);return this},debug:function(e){if(e===undefined){return this._debug}this._debug=!!e;return this},enter:function(e){this._onenter=e;return this},progress:function(e){this._onprogress=e;return this},styles:function(e){var t=new a(this);if(e){t.extend(e)}return t},init:function(){this._framePositions.sort(function(e,t){return Number(e)-Number(t)});var e=this._framePositions;this.startPos=e[0];this.endPos=e[e.length-1];this.initialized=true},render:function(){var t=this.target,n=this.keyframes,r=this.startPos,i=this.endPos,s=this._onprogress,o={};if(!this.initialized){throw new Error("not yet initialized")}if(!this.rendering){t[0].style.display="block";if(n[0].styles){t.css(n[0].styles)}if(typeof this._onenter==="function"){var u=this._onenter.call(this);if(u instanceof a){u=u.get()}e.extend(o,u)}this.rendering=true}for(var l=1,c=n.length;l<c;l++){var p=n[l],d=p.options||{},v=n[l-1],m=v.options||{},g=m.enter,y=d.progress,b=typeof d.easing==="string"?f[d.easing]:f.linear,w=v.scrollTop,E=p.scrollTop,S=v.current;v.current=p.current=false;var x=this.container.tweenTop;if(x<w||E<x){continue}v.current=true;if(!S&&typeof g==="function"){var T=g.call(this);if(T instanceof a){T=T.get()}e.extend(T,v.styles);v.styles=T}var N=(w-x)/(w-E);if(typeof y==="function"){var T=y.call(this,N);if(T){if(T instanceof a){T=T.get()}e.extend(T,p.styles);p.styles=T}}if(!p.styles){continue}for(var C in v.styles){var k=v.styles[C];var L=p.styles[C];if(L===undefined||L===null){p.styles[C]=L=k}k=h(k);L=h(L);var A=L.value-k.value;var O=b(N)*A+k.value;if(typeof L.unit==="string"){O+=L.unit}o[C]=O}}if(typeof s==="function"){var M=(r-x)/(r-i);var _=this._onprogress.call(this,M);if(_){if(_ instanceof a){_=_.get()}e.extend(o,_)}}t.css(o)},end:function(){if(!this.container.isScrollEnd()){this.target[0].style.display="none"}this.rendering=false}};var c=/([\d\.\-]+)([^\d]+)/;ScrollTween.container=function(e,t){return new o(e,t)}})(jQuery)